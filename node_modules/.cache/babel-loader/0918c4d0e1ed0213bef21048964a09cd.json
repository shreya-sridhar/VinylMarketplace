{"ast":null,"code":"var _jsxFileName = \"/home/shreyamohak/vinyl/vinyl-mp-frontend/vinyl-mp-frontend/src/containers/MainContainer.js\";\nimport React from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport Footer from '../components/Footer.js';\nimport RecordPage from './RecordPage.js';\nimport NavBar from \"./NavBar\";\nimport NotFound from \"../components/NotFound\";\nimport Main from \"../pages/main/Main\";\nimport Messages from \"../pages/main/Messages\";\nimport Login from \"./Login\";\nimport History from \"./History\";\nimport Cart from \"./Cart\";\nimport UserHome from \"../containers/UserHome\";\nimport Friends from \"./ChatFriends\";\nimport AllRecords from \"../pages/all-records/AllRecords\";\nimport { Route, Switch, Redirect, Link } from \"react-router-dom\";\nimport { withRouter } from 'react-router';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API = \"http://localhost:3001/\";\n\nclass MainContainer extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      records: [],\n      users: [],\n      sell_records: [],\n      cover: [true, \"View List Of Songs\"],\n      page: 1,\n      recordPage: 0,\n      user1Page: 0,\n      user2Page: 0,\n      user: {},\n      error: false,\n      orders: [],\n      order_records: [],\n      redirect: false\n    };\n\n    this.downloadUsers = () => {\n      fetch(\"http://localhost:3001/users\").then(res => res.json()).then(data1 => fetch(\"http://localhost:3001/records\").then(res => res.json()).then(data2 => fetch(\"http://localhost:3001/sell_records\").then(res => res.json()).then(data3 => fetch(\"http://localhost:3001/order_records\").then(res => res.json()).then(data4 => fetch(\"http://localhost:3001/orders\").then(res => res.json()).then(data5 => {\n        this.setState({\n          users: data1,\n          records: data2,\n          sell_records: data3,\n          order_records: data4,\n          orders: data5\n        });\n      })))));\n    };\n\n    this.persistUser = token => {\n      debugger;\n      fetch(API + `profile`, {\n        method: \"GET\",\n        headers: {\n          Authorization: `${token}`\n        }\n      }).then(resp => resp.json()).then(data => {\n        debugger;\n\n        if (data.user) {\n          const {\n            username,\n            id\n          } = data.user;\n          this.setState({\n            user: {\n              username,\n              id\n            }\n          });\n        }\n      });\n    };\n\n    this.handleTabClick = tab => {\n      let newPage;\n\n      if (tab === \"friends\") {\n        newPage = 2;\n      } else if (tab === \"favorites\") {\n        newPage = 3;\n      } else {\n        newPage = 1;\n      }\n\n      this.setState({\n        page: newPage\n      });\n    };\n\n    this.handleClick = () => {\n      let newCover = !this.state.cover[0];\n      let newTitle;\n\n      if (this.state.cover[1] === \"View Album Cover\") {\n        newTitle = \"View List Of Songs\";\n      } else {\n        newTitle = \"View Album Cover\";\n      }\n\n      this.setState({\n        cover: [newCover, newTitle]\n      });\n    };\n\n    this.handleRightClick = (pg, n) => {\n      let changePage = pg + `Page`;\n      let pageNum = this.state[changePage] + 4;\n\n      if (pageNum >= n) {\n        pageNum = 0;\n      }\n\n      this.setState({\n        [`${changePage}`]: pageNum\n      });\n    };\n\n    this.handleLeftClick = (pg, n) => {\n      let changePage = pg + `Page`;\n      let pageNum = this.state[changePage] - 4;\n\n      if (pageNum <= 0) {\n        pageNum = n - 4;\n      }\n\n      this.setState({\n        [`${changePage}`]: pageNum\n      });\n    };\n\n    this.setRedirect = () => {\n      this.setState({\n        redirect: true\n      });\n    };\n\n    this.renderRedirect = () => {\n      if (this.state.redirect) {\n        return /*#__PURE__*/_jsxDEV(Redirect, {\n          to: \"/login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 20\n        }, this);\n      }\n    };\n\n    this.addToCart = rec => {\n      if (!localStorage.token) {\n        alert('Please login before adding to cart');\n      } else {\n        alert(rec.name + ' has been added to your cart!');\n        let user_find = this.state.orders.filter(order => order.user.id === this.state.user.id && order.status === 'in_cart'); // change to single element later\n\n        if (user_find.length === 0) {\n          debugger;\n          fetch(\"http://localhost:3001/orders\", {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n              user_id: this.state.user.id,\n              status: 'in_cart',\n              total_sum: 0.0\n            })\n          }).then(resp => resp.json()).then(data => {\n            debugger; // let newOrders = this.state.order.concat(data)\n            // this.setState({orders:newOrders})\n\n            this.createOrderRecord(data);\n          });\n        } else {\n          debugger;\n          this.createOrderRecord(rec);\n        }\n      }\n    };\n\n    this.createOrderRecord = rec => {\n      debugger;\n      let currOrder = this.state.orders.filter(order => order.user.id === this.state.user.id && order.status === 'in_cart')[0];\n      debugger; // change to single element later\n\n      fetch(\"http://localhost:3001/order_records\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          order_id: currOrder.id,\n          record_id: rec.id\n        })\n      }).then(resp => resp.json()).then(data => {\n        this.downloadUsers();\n      });\n    };\n\n    this.handleAuthResponse = data => {\n      if (data.message === \"Invalid username or password\") {\n        this.props.history.push(\"/signup\");\n      } else {\n        if (data.user) {\n          const {\n            username,\n            id\n          } = data.user;\n          const token = data.jwt;\n          this.setState({\n            user: {\n              username,\n              id\n            },\n            error: null\n          });\n          localStorage.setItem(\"token\", token);\n          this.props.history.push(\"/records\");\n        } else if (data.error) {\n          this.setState({\n            error: data.error\n          });\n        }\n      }\n    };\n\n    this.handleLogin = (e, user) => {\n      e.preventDefault();\n      fetch(API + `login`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          username: user.username,\n          password: user.password,\n          bio: \"\"\n        })\n      }).then(resp => resp.json()).then(data => {\n        this.handleAuthResponse(data);\n      }).catch(console.log);\n    };\n\n    this.handleSignup = (e, user) => {\n      e.preventDefault();\n      fetch(API + `/signup`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          user: user\n        })\n      }).then(resp => resp.json()).then(data => {\n        this.handleAuthResponse(data);\n      }).catch(console.log);\n    };\n\n    this.handleLogout = () => {\n      localStorage.clear();\n      this.setState({\n        user: {}\n      });\n    };\n\n    this.sendMessage = (e, state) => {\n      fetch(\"http://localhost:3002/messages\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          content: state.message\n        })\n      }).then(resp => resp.json()).then(data => {\n        console.log(data);\n      });\n    };\n\n    this.renderLoginPage = () => /*#__PURE__*/_jsxDEV(Login, {\n      handleLoginOrSignup: this.handleLogin,\n      act: \"login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 29\n    }, this);\n\n    this.renderSignUpPage = () => /*#__PURE__*/_jsxDEV(Login, {\n      handleLoginOrSignup: this.handleSignup,\n      act: \"signup\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 30\n    }, this);\n\n    this.renderMessages = () => /*#__PURE__*/_jsxDEV(Messages, {\n      sendMessage: this.sendMessage,\n      user: this.state.user\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 28\n    }, this);\n\n    this.renderHistory = () => /*#__PURE__*/_jsxDEV(History, {\n      order_records: this.state.order_records\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 27\n    }, this);\n\n    this.changeCartStatus = () => {\n      let order_find = this.state.orders.find(order => order.user.id === this.state.user.id && order.status === 'in_cart').id; // change to single element later\n\n      fetch(`http://localhost:3001/orders/${order_find}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          status: \"complete\"\n        })\n      }).then(resp => resp.json()).then(data => console.log);\n    };\n\n    this.deleteRecord = order_rec => {\n      fetch(`http://localhost:3001/order_records/${order_rec.id}`, {\n        method: 'DELETE'\n      }).then(res => res.json()).then(res => {\n        this.downloadUsers();\n      });\n    };\n  }\n\n  componentDidMount() {\n    const token = localStorage.token;\n\n    if (token) {\n      this.persistUser(token);\n    }\n\n    this.downloadUsers();\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(NavBar, {\n        user: this.state.user,\n        handleLogout: this.handleLogout\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/\",\n          component: Main\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/messages\",\n          render: this.renderMessages\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/records\",\n          component: AllRecords\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/login\",\n          render: this.renderLoginPage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/signup\",\n          render: this.renderSignUpPage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/history\",\n          render: this.renderHistory\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/users/:slug\",\n          render: routerProps => {\n            let user = this.state.users.find(user => user.id == routerProps.match.params.slug);\n            return user ? /*#__PURE__*/_jsxDEV(UserHome, {\n              user: user,\n              users: this.state.users,\n              records: this.state.records,\n              nums: this.state.records.length,\n              content1: \"Recently Bought\",\n              content2: \"Currently Selling\",\n              size: 200,\n              page: this.state.page,\n              handleTabClick: this.handleTabClick,\n              handleRightClick: this.handleRightClick,\n              handleLeftClick: this.handleLeftClick,\n              user1Page: this.state.user1Page,\n              sell_records: this.state.sell_records,\n              user2Page: this.state.user2Page\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 39\n            }, this) : null;\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/records/:slug\",\n          render: routerProps => {\n            return /*#__PURE__*/_jsxDEV(RecordPage, {\n              record_id: routerProps.match.params.slug,\n              records: this.state.records,\n              handleClick: this.handleClick,\n              cover: this.state.cover,\n              handleRightClick: this.handleRightClick,\n              handleLeftClick: this.handleLeftClick,\n              sell_records: this.state.sell_records,\n              user: this.state.user,\n              deleteRecord: this.deleteRecord,\n              changeCartStatus: this.changeCartStatus,\n              addToCart: this.addToCart,\n              recordPage: this.state.recordPage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 32\n            }, this);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/cart/:slug\",\n          render: routerProps => {\n            let user = this.state.users.find(u => u.id == routerProps.match.params.slug);\n            return user ? /*#__PURE__*/_jsxDEV(Cart, {\n              user: user,\n              deleteRecord: this.deleteRecord,\n              changeCartStatus: this.changeCartStatus\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 368,\n              columnNumber: 39\n            }, this) : null;\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/friends\",\n          component: Friends\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          component: NotFound\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default _c = withRouter(MainContainer);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["/home/shreyamohak/vinyl/vinyl-mp-frontend/vinyl-mp-frontend/src/containers/MainContainer.js"],"names":["React","Footer","RecordPage","NavBar","NotFound","Main","Messages","Login","History","Cart","UserHome","Friends","AllRecords","Route","Switch","Redirect","Link","withRouter","API","MainContainer","Component","state","records","users","sell_records","cover","page","recordPage","user1Page","user2Page","user","error","orders","order_records","redirect","downloadUsers","fetch","then","res","json","data1","data2","data3","data4","data5","setState","persistUser","token","method","headers","Authorization","resp","data","username","id","handleTabClick","tab","newPage","handleClick","newCover","newTitle","handleRightClick","pg","n","changePage","pageNum","handleLeftClick","setRedirect","renderRedirect","addToCart","rec","localStorage","alert","name","user_find","filter","order","status","length","body","JSON","stringify","user_id","total_sum","createOrderRecord","currOrder","order_id","record_id","handleAuthResponse","message","props","history","push","jwt","setItem","handleLogin","e","preventDefault","password","bio","catch","console","log","handleSignup","handleLogout","clear","sendMessage","content","renderLoginPage","renderSignUpPage","renderMessages","renderHistory","changeCartStatus","order_find","find","deleteRecord","order_rec","componentDidMount","render","routerProps","match","params","slug","u"],"mappings":"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","sourcesContent":["import React from 'react'\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport Footer from '../components/Footer.js'\nimport RecordPage from './RecordPage.js'\nimport NavBar from \"./NavBar\"\nimport NotFound from \"../components/NotFound\"\nimport Main from \"../pages/main/Main\"\nimport Messages from \"../pages/main/Messages\"\nimport Login from \"./Login\"\nimport History from \"./History\"\nimport Cart from \"./Cart\"\nimport UserHome from \"../containers/UserHome\"\nimport Friends from \"./ChatFriends\"\nimport AllRecords from \"../pages/all-records/AllRecords\";\nimport {Route, Switch, Redirect, Link} from \"react-router-dom\";\nimport {withRouter} from 'react-router'\n\nconst API = \"http://localhost:3001/\"\n\nclass MainContainer extends React.Component {\n\n    state = {\n        records: [],\n        users: [],\n        sell_records: [],\n        cover:[true,\"View List Of Songs\"],\n        page: 1,\n        recordPage: 0,\n        user1Page: 0,\n        user2Page: 0,\n        user: {},\n        error: false,\n        orders: [],\n        order_records: [],\n        redirect: false,\n    }\n\n    downloadUsers = () => {\n        fetch(\"http://localhost:3001/users\")\n            .then(res => res.json())\n            .then(data1 => fetch(\"http://localhost:3001/records\")\n                .then(res => res.json())\n                .then(data2 => fetch(\"http://localhost:3001/sell_records\")\n                    .then(res => res.json())\n                    .then(data3 => fetch(\"http://localhost:3001/order_records\")\n                        .then(res => res.json())\n                        .then(data4 => fetch(\"http://localhost:3001/orders\")\n                            .then(res => res.json())\n                            .then(data5 => {\n                                    this.setState(\n                                        {\n                                            users: data1,\n                                            records: data2,\n                                            sell_records: data3,\n                                            order_records: data4,\n                                            orders: data5\n                                        })\n                                }\n                            )\n                        ))))\n    }\n\n    componentDidMount() {\n        const token = localStorage.token;\n        if (token) {\n            this.persistUser(token);\n        }\n\n        this.downloadUsers()\n    }\n\n    persistUser = (token) => {\n        debugger\n        fetch(API + `profile`, {\n            method: \"GET\",\n            headers: {\n                Authorization: `${token}`,\n            },\n        })\n            .then((resp) => resp.json())\n            .then((data) => {\n                debugger\n                if (data.user) {\n                    const {username, id} = data.user;\n                    this.setState({\n                        user: {\n                            username,\n                            id,\n                        },\n                    });\n                }\n            });\n    };\n\n\n    handleTabClick = (tab) => {\n        let newPage\n        if (tab === \"friends\") {\n            newPage = 2\n        } else if (tab === \"favorites\") {\n            newPage = 3\n        } else {\n            newPage = 1\n        }\n        this.setState({\n            page: newPage\n        })\n    }\n\n    handleClick = () => {\n        let newCover = !this.state.cover[0]\n        let newTitle\n        if (this.state.cover[1] === \"View Album Cover\") {\n            newTitle = \"View List Of Songs\"\n        } else {\n            newTitle = \"View Album Cover\"\n        }\n        this.setState({\n            cover: [newCover, newTitle]\n        })\n    }\n\n    handleRightClick = (pg, n) => {\n        let changePage = pg + `Page`\n        let pageNum = this.state[changePage] + 4\n        if (pageNum >= n) {\n            pageNum = 0\n        }\n        this.setState({\n            [`${changePage}`]: pageNum\n        })\n    }\n\n    handleLeftClick = (pg, n) => {\n        let changePage = pg + `Page`\n        let pageNum = this.state[changePage] - 4\n        if (pageNum <= 0) {\n            pageNum = n - 4\n        }\n        this.setState({\n            [`${changePage}`]: pageNum\n        })\n    }\n\n    setRedirect = () => {\n        this.setState({\n            redirect: true\n        })\n    }\n    renderRedirect = () => {\n        if (this.state.redirect) {\n            return <Redirect to='/login'/>\n        }\n    }\n\n    addToCart = (rec) => {\n        if (!localStorage.token) {\n            alert('Please login before adding to cart');\n        } else {\n            alert(rec.name + ' has been added to your cart!');\n            let user_find = this.state.orders.filter((order) => order.user.id === this.state.user.id && order.status === 'in_cart')\n            // change to single element later\n            if (user_find.length === 0) {\n                debugger\n                fetch(\"http://localhost:3001/orders\", {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\",\n                    },\n                    body: JSON.stringify({user_id: this.state.user.id, status: 'in_cart', total_sum: 0.0}),\n                })\n                    .then((resp) => resp.json())\n                    .then((data) => {\n                        debugger\n                        // let newOrders = this.state.order.concat(data)\n                        // this.setState({orders:newOrders})\n                        this.createOrderRecord(data);\n                    })\n            } else {\n                debugger\n                this.createOrderRecord(rec);\n            }\n        }\n    }\n\n\n    createOrderRecord = (rec) => {\n        debugger\n        let currOrder = this.state.orders.filter((order) => order.user.id === this.state.user.id && order.status === 'in_cart')[0]\n        debugger\n        // change to single element later\n        fetch(\"http://localhost:3001/order_records\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({order_id: currOrder.id, record_id: rec.id}),\n        })\n            .then((resp) => resp.json())\n            .then((data) => {\n                this.downloadUsers()\n            })\n    }\n\n\n    handleAuthResponse = (data) => {\n        if (data.message === \"Invalid username or password\") {\n            this.props.history.push(\"/signup\");\n        } else {\n            if (data.user) {\n                const {username, id} = data.user;\n                const token = data.jwt\n                this.setState({\n                    user: {\n                        username,\n                        id,\n                    },\n                    error: null,\n                });\n\n                localStorage.setItem(\"token\", token);\n                this.props.history.push(\"/records\");\n            } else if (data.error) {\n                this.setState({\n                    error: data.error,\n                });\n            }\n        }\n    };\n\n    handleLogin = (e, user) => {\n        e.preventDefault();\n        fetch(API + `login`, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({username: user.username, password: user.password, bio: \"\"}),\n        })\n            .then((resp) => resp.json())\n            .then((data) => {\n                this.handleAuthResponse(data);\n            })\n            .catch(console.log);\n    };\n\n    handleSignup = (e, user) => {\n        e.preventDefault();\n\n        fetch(API + `/signup`, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({user: user}),\n        })\n            .then((resp) => resp.json())\n            .then((data) => {\n                this.handleAuthResponse(data);\n            })\n            .catch(console.log);\n    };\n\n    handleLogout = () => {\n        localStorage.clear();\n        this.setState({user: {}});\n    };\n\n    sendMessage = (e, state) => {\n\n        fetch(\"http://localhost:3002/messages\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n\n            },\n            body: JSON.stringify({content: state.message}),\n        })\n            .then((resp) => resp.json())\n            .then((data) => {\n\n                console.log(data)\n            })\n    }\n\n    renderLoginPage = () => <Login handleLoginOrSignup={this.handleLogin} act=\"login\"/>;\n    renderSignUpPage = () => <Login handleLoginOrSignup={this.handleSignup} act=\"signup\"/>;\n    renderMessages = () => <Messages sendMessage={this.sendMessage} user={this.state.user}/>\n    renderHistory = () => <History order_records={this.state.order_records}/>\n\n    changeCartStatus = () => {\n        let order_find = this.state.orders.find((order) => order.user.id === this.state.user.id && order.status === 'in_cart').id\n        // change to single element later\n\n        fetch(`http://localhost:3001/orders/${order_find}`, {\n            method: \"PATCH\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({status: \"complete\"}),\n        })\n            .then((resp) => resp.json())\n            .then((data) =>\n                console.log)\n    }\n\n    deleteRecord = (order_rec) => {\n\n        fetch(`http://localhost:3001/order_records/${order_rec.id}`, {\n            method: 'DELETE',\n        })\n            .then(res => res.json())\n            .then(res => {\n                this.downloadUsers()\n            })\n    }\n\n\n    render() {\n        return (\n            <div>\n                <NavBar user={this.state.user}\n                        handleLogout={this.handleLogout}\n                />\n                <Switch>\n                    <Route exact path=\"/\" component={Main}/>\n                    <Route exact path=\"/messages\" render={this.renderMessages}/>\n                    <Route exact path=\"/records\" component={AllRecords}/>\n\n                    <Route path=\"/login\" render={this.renderLoginPage}/>\n                    <Route path=\"/signup\" render={this.renderSignUpPage}/>\n                    <Route path=\"/history\" render={this.renderHistory}/>\n\n                    <Route path=\"/users/:slug\" render={(routerProps) => {\n                        let user = this.state.users.find(user => user.id == routerProps.match.params.slug)\n                        return user ? <UserHome user={user} users={this.state.users} records={this.state.records}\n                                                nums={this.state.records.length} content1={\"Recently Bought\"}\n                                                content2={\"Currently Selling\"} size={200} page={this.state.page}\n                                                handleTabClick={this.handleTabClick}\n                                                handleRightClick={this.handleRightClick}\n                                                handleLeftClick={this.handleLeftClick} user1Page={this.state.user1Page}\n                                                sell_records={this.state.sell_records}\n                                                user2Page={this.state.user2Page}/> : null\n                    }}\n                    />\n\n\n                    <Route path=\"/records/:slug\" render={(routerProps) => {\n                        return <RecordPage record_id={routerProps.match.params.slug}\n                                           records={this.state.records}\n                                           handleClick={this.handleClick}\n                                           cover={this.state.cover}\n                                           handleRightClick={this.handleRightClick}\n                                           handleLeftClick={this.handleLeftClick}\n                                           sell_records={this.state.sell_records}\n                                           user={this.state.user}\n                                           deleteRecord={this.deleteRecord}\n                                           changeCartStatus={this.changeCartStatus}\n                                           addToCart={this.addToCart}\n                                           recordPage={this.state.recordPage}/>\n                    }}/>\n\n\n                    {/* {!this.state.user.id && <Redirect to=\"/login\" />} */}\n\n                    <Route path=\"/cart/:slug\" render={(routerProps) => {\n                        let user = this.state.users.find(u => u.id == routerProps.match.params.slug)\n                        return user ? <Cart user={user} deleteRecord={this.deleteRecord}\n                                            changeCartStatus={this.changeCartStatus}/> : null\n                    }}/>\n\n\n                    <Route exact path=\"/friends\" component={Friends}/>\n                    <Route component={NotFound}/>\n\n                </Switch>\n                <Footer/>\n            </div>\n        );\n    }\n\n}\n\nexport default withRouter(MainContainer);\n\n"]},"metadata":{},"sourceType":"module"}